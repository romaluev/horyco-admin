# Admin Panel — Самостоятельная регистрация и онбординг

Этот документ описывает процесс **self-service onboarding** — автоматизированную регистрацию и настройку нового ресторана без участия менеджеров OshLab. Новый клиент самостоятельно проходит все этапы от регистрации до запуска системы.

---

## 📋 Содержание

1. [Что такое Self-Onboarding](#что-такое-self-onboarding)
2. [Этапы онбординга](#этапы-онбординга)
3. [Страница: Регистрация](#страница-регистрация)
4. [Страница: Информация о бизнесе](#страница-информация-о-бизнесе)
5. [Страница: Настройка филиала](#страница-настройка-филиала)
6. [Страница: Выбор меню](#страница-выбор-меню)
7. [Страница: Платёжные методы](#страница-платёжные-методы)
8. [Страница: Приглашение сотрудников](#страница-приглашение-сотрудников)
9. [Страница: Завершение онбординга](#страница-завершение-онбординга)
10. [Отслеживание прогресса](#отслеживание-прогресса)

---

## Что такое Self-Onboarding?

### 🎯 Цель системы

**Self-Onboarding** — это автоматизированный процесс, который позволяет новому клиенту:
- Зарегистрироваться самостоятельно
- Настроить систему за 10-15 минут
- Начать работу без помощи техподдержки

### 🚀 Преимущества

**Для клиента:**
- Быстрый старт (запуск в день регистрации)
- Интуитивный пошаговый процесс
- Готовые шаблоны меню
- Не нужно ждать менеджера

**Для OshLab:**
- Масштабируемость (автоматизация)
- Снижение нагрузки на поддержку
- Увеличение конверсии регистраций
- Сбор структурированных данных о клиентах

### 💡 Как это работает

```
Новый клиент
    ↓
Регистрация по телефону + OTP
    ↓
Создание Tenant (ресторана)
    ↓
Пошаговый Wizard (7 шагов)
    ↓
Готовая система для работы
```

---

## Этапы онбординга

### 📊 Структура Onboarding Wizard

Онбординг состоит из **7 последовательных этапов**:

```
┌─────────────────────────────────────────────────────────┐
│  Прогресс: ████████░░░░░░░░ 4/7 (57%)                  │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  ✅ 1. Регистрация (REGISTRATION_COMPLETE)             │
│  ✅ 2. Информация о бизнесе (BUSINESS_INFO_VERIFIED)   │
│  ✅ 3. Настройка филиала (BRANCH_SETUP)                │
│  ✅ 4. Выбор меню (MENU_TEMPLATE)                      │
│  🔄 5. Платёжные методы (PAYMENT_SETUP) ← ВЫ ЗДЕСЬ    │
│  ⏸️  6. Приглашение сотрудников (STAFF_INVITED)        │
│  ⏸️  7. Готово к запуску (GO_LIVE)                     │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

### 🔑 Обязательные vs Опциональные шаги

| Шаг | Название | Обязательный | Можно пропустить |
|-----|----------|--------------|------------------|
| 1 | Регистрация | ✅ Да | ❌ Нет |
| 2 | Информация о бизнесе | ✅ Да | ❌ Нет |
| 3 | Настройка филиала | ✅ Да | ❌ Нет |
| 4 | Выбор меню | ✅ Да | ❌ Нет |
| 5 | Платёжные методы | ⚠️ Опционально | ✅ Да (можно настроить позже) |
| 6 | Приглашение сотрудников | ⚠️ Опционально | ✅ Да (можно добавить позже) |
| 7 | Готово к запуску | ✅ Да | ❌ Нет |

### 🎬 Жизненный цикл онбординга

```
Новый пользователь
  ↓
POST /auth/register (+ OTP верификация)
  ↓
Tenant создан, OnboardingProgress инициализирован
  ↓
currentStep = REGISTRATION_COMPLETE
completedSteps = [REGISTRATION_COMPLETE]
isCompleted = false
  ↓
Пользователь проходит шаги 2-6
  ↓
POST /admin/onboarding/complete
  ↓
isCompleted = true
completedAt = 2025-01-24T12:00:00Z
  ↓
Ресторан готов к работе! 🎉
```

---

## Страница: Регистрация

### 📍 Навигация
**URL:** `/register` или `/signup`
**Доступ:** Публичный (без JWT)

### 🎯 Цель страницы
Регистрация нового ресторана в системе OshLab.

### 📋 API Endpoints

#### 1. Отправить OTP код
```http
POST /auth/register/send-otp
Content-Type: application/json

{
  "phone": "+998901234567",
  "businessName": "Пицца Хаус"
}
```

**Response:**
```json
{
  "success": true,
  "message": "OTP код отправлен на +998901234567",
  "otpSentAt": "2025-01-24T10:00:00Z",
  "expiresIn": 180,
  "maskedPhone": "+998 90 ***-**-67"
}
```

**Что происходит:**
- Система проверяет, что телефон не зарегистрирован
- Генерируется 6-значный код (например: 123456)
- Код отправляется через SMS-провайдера
- Код действителен 3 минуты (180 секунд)

#### 2. Подтвердить OTP и завершить регистрацию
```http
POST /auth/register/verify-otp
Content-Type: application/json

{
  "phone": "+998901234567",
  "otp": "123456",
  "businessName": "Пицца Хаус",
  "ownerName": "Иван Иванов",
  "password": "SecurePassword123!"
}
```

**Response:**
```json
{
  "success": true,
  "accessToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "refreshToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "user": {
    "id": 1,
    "tenantId": 5,
    "phone": "+998901234567",
    "fullName": "Иван Иванов",
    "roles": ["owner"],
    "permissions": ["*"]
  },
  "tenant": {
    "id": 5,
    "businessName": "Пицца Хаус",
    "status": "onboarding",
    "createdAt": "2025-01-24T10:05:00Z"
  },
  "onboardingProgress": {
    "currentStep": "REGISTRATION_COMPLETE",
    "completedSteps": ["REGISTRATION_COMPLETE"],
    "completionPercentage": 14,
    "isCompleted": false
  }
}
```

**Что происходит внутри системы:**
1. Проверяется OTP код
2. Создаётся **Tenant** (tenantId)
3. Создаётся первый **User** с ролью `owner`
4. Создаётся **Branch** по умолчанию ("Главный филиал")
5. Инициализируется **OnboardingProgress**
6. Генерируются JWT токены
7. Возвращается полный контекст для старта

### 🎨 UI Компоненты

**Форма регистрации (Шаг 1 — Ввод данных):**
```
┌─────────────────────────────────────────┐
│  🎉 Добро пожаловать в OshLab!          │
│                                         │
│  Телефон: [+998 __ ___ __ __]           │
│  Название бизнеса: [_________________]  │
│  Ваше имя: [_______________________]    │
│  Пароль: [________________________]     │
│  Повторите пароль: [_______________]    │
│                                         │
│  [✓] Я согласен с условиями             │
│                                         │
│  [Получить код по SMS]                  │
└─────────────────────────────────────────┘
```

**Форма регистрации (Шаг 2 — Подтверждение OTP):**
```
┌─────────────────────────────────────────┐
│  📱 Введите код из SMS                  │
│                                         │
│  Код отправлен на +998 90 ***-**-67     │
│                                         │
│  ┌───┐ ┌───┐ ┌───┐ ┌───┐ ┌───┐ ┌───┐  │
│  │ 1 │ │ 2 │ │ 3 │ │ 4 │ │ 5 │ │ 6 │  │
│  └───┘ └───┘ └───┘ └───┘ └───┘ └───┘  │
│                                         │
│  Код действителен: 02:45                │
│                                         │
│  [Отправить повторно] [Подтвердить]     │
└─────────────────────────────────────────┘
```

### ✅ Проверки и валидация

**Телефон:**
- Формат: +998 XX XXX XX XX (узбекский номер)
- Проверка, что номер не зарегистрирован
- Маскировка в UI: +998 90 ***-**-67

**Название бизнеса:**
- Обязательное поле
- Минимум 3 символа
- Максимум 100 символов
- Разрешены буквы, цифры, пробелы

**Пароль:**
- Минимум 8 символов
- Минимум 1 заглавная буква
- Минимум 1 цифра
- Минимум 1 специальный символ

**OTP код:**
- 6 цифр
- Действителен 3 минуты
- Максимум 3 попытки ввода
- После 3 неудачных попыток — повторная отправка

### 🔄 Сценарии использования

**Успешная регистрация:**
```
1. Пользователь вводит телефон и данные
2. Нажимает "Получить код по SMS"
3. POST /auth/register/send-otp
4. Получает SMS с кодом 123456
5. Вводит код в форму
6. POST /auth/register/verify-otp
7. Получает токены и переходит на онбординг
```

**Повторная отправка OTP:**
```
1. Код не пришёл или истёк
2. Кнопка "Отправить повторно" (доступна через 60 сек)
3. POST /auth/register/send-otp (повторно)
4. Новый код отправлен
```

**Ошибка: телефон уже зарегистрирован:**
```
1. Ввод телефона +998901234567
2. POST /auth/register/send-otp
3. Response: 400 Bad Request
   {
     "message": "Этот номер уже зарегистрирован",
     "error": "PHONE_ALREADY_EXISTS"
   }
4. Показать: "У вас уже есть аккаунт. [Войти]"
```

---

## Страница: Информация о бизнесе

### 📍 Навигация
**URL:** `/onboarding/business-info`
**Требуется:** JWT токен (зарегистрированный пользователь)

### 🎯 Цель страницы
Сбор подробной информации о ресторане для персонализации системы.

### 📋 API Endpoint

```http
POST /admin/onboarding/steps/business-info
Authorization: Bearer <token>
Content-Type: application/json

{
  "businessType": "restaurant",
  "description": "Сеть пиццерий с итальянской кухней",
  "address": "г. Ташкент, ул. Навои 15",
  "website": "https://pizzahouse.uz",
  "regionId": 1,
  "districtId": 5
}
```

**Response:**
```json
{
  "currentStep": "BRANCH_SETUP",
  "completedSteps": [
    "REGISTRATION_COMPLETE",
    "BUSINESS_INFO_VERIFIED"
  ],
  "completionPercentage": 28,
  "stepData": {
    "BUSINESS_INFO_VERIFIED": {
      "businessType": "restaurant",
      "description": "Сеть пиццерий с итальянской кухней",
      "completedAt": "2025-01-24T10:10:00Z"
    }
  }
}
```

### 🎨 UI Компоненты

```
┌─────────────────────────────────────────────────────┐
│  Шаг 2 из 7: Расскажите о вашем бизнесе            │
│  Прогресс: ████░░░░░░░░░░░░ 28%                    │
├─────────────────────────────────────────────────────┤
│                                                     │
│  Тип заведения: *                                   │
│  ( ) Кофейня                                        │
│  (•) Ресторан                                       │
│  ( ) Пиццерия                                       │
│  ( ) Фаст-фуд                                       │
│  ( ) Кафе                                           │
│  ( ) Суши-бар                                       │
│                                                     │
│  Описание:                                          │
│  [_____________________________________________]    │
│  [_____________________________________________]    │
│  (Опишите вашу кухню, концепцию, особенности)      │
│                                                     │
│  Адрес: *                                           │
│  Регион: [▼ Ташкент______________________]          │
│  Район: [▼ Мирзо-Улугбекский район________]         │
│  Адрес: [г. Ташкент, ул. Навои 15_________]         │
│                                                     │
│  Сайт (необязательно):                              │
│  [https://pizzahouse.uz___________________]         │
│                                                     │
│  [← Назад]  [Пропустить]  [Далее →]                │
└─────────────────────────────────────────────────────┘
```

### 💡 Бизнес-логика

**BusinessType (Тип заведения):**
- `coffee_shop` — Кофейня
- `restaurant` — Ресторан
- `pizzeria` — Пиццерия
- `fast_food` — Фаст-фуд
- `cafe` — Кафе
- `sushi_bar` — Суши-бар
- `bakery` — Пекарня
- `bar` — Бар

**Зачем нужен тип заведения:**
- Подбор подходящего шаблона меню
- Настройка дефолтных параметров
- Персонализация интерфейса
- Аналитика по индустриям

**Регион и Район:**
- Используются для:
  - Геолокации филиалов
  - Зонирования доставки
  - Аналитики по регионам
  - Интеграции с картами

### ✅ Проверки

- `businessType` — обязательное поле
- `address` — обязательное поле, минимум 10 символов
- `description` — максимум 500 символов
- `website` — валидный URL (если указан)

---

## Страница: Настройка филиала

### 📍 Навигация
**URL:** `/onboarding/branch-setup`

### 🎯 Цель страницы
Настройка первого филиала: название, адрес, режим работы, типы обслуживания.

### 📋 API Endpoint

```http
POST /admin/onboarding/steps/branch-setup
Authorization: Bearer <token>

{
  "branchName": "Пицца Хаус — Центр",
  "address": "г. Ташкент, пр. Амира Темура 10",
  "businessHours": {
    "monday": { "open": "09:00", "close": "23:00" },
    "tuesday": { "open": "09:00", "close": "23:00" },
    "wednesday": { "open": "09:00", "close": "23:00" },
    "thursday": { "open": "09:00", "close": "23:00" },
    "friday": { "open": "09:00", "close": "01:00" },
    "saturday": { "open": "10:00", "close": "01:00" },
    "sunday": { "open": "10:00", "close": "23:00" }
  },
  "dineInEnabled": true,
  "takeawayEnabled": true,
  "deliveryEnabled": false
}
```

### 🎨 UI Компоненты

```
┌─────────────────────────────────────────────────────┐
│  Шаг 3 из 7: Настройте ваш филиал                  │
│  Прогресс: ████████░░░░░░ 42%                       │
├─────────────────────────────────────────────────────┤
│                                                     │
│  Название филиала: *                                │
│  [Пицца Хаус — Центр__________________________]    │
│                                                     │
│  Адрес: *                                           │
│  [г. Ташкент, пр. Амира Темура 10_____________]    │
│                                                     │
│  Режим работы:                                      │
│  ┌─────────────────────────────────────────────┐   │
│  │ Пн  [09:00] - [23:00]  [✓] Круглосуточно   │   │
│  │ Вт  [09:00] - [23:00]  [ ]                  │   │
│  │ Ср  [09:00] - [23:00]  [ ]                  │   │
│  │ Чт  [09:00] - [23:00]  [ ]                  │   │
│  │ Пт  [09:00] - [01:00]  [ ]                  │   │
│  │ Сб  [10:00] - [01:00]  [ ]                  │   │
│  │ Вс  [10:00] - [23:00]  [ ] Выходной         │   │
│  └─────────────────────────────────────────────┘   │
│                                                     │
│  Типы обслуживания:                                 │
│  [✓] Обслуживание в зале (Dine-in)                 │
│  [✓] На вынос (Takeaway)                           │
│  [ ] Доставка (Delivery)                           │
│                                                     │
│  [← Назад]  [Далее →]                              │
└─────────────────────────────────────────────────────┘
```

### 💡 Бизнес-логика

**Типы обслуживания:**
- `dineInEnabled` — Обслуживание в зале
  - Включает управление столами
  - Назначение официантов
  - Чаевые

- `takeawayEnabled` — На вынос
  - Упрощённый checkout
  - Время готовности
  - SMS уведомления

- `deliveryEnabled` — Доставка
  - Зоны доставки
  - Стоимость доставки
  - Интеграция с курьерами

**Режим работы:**
- Устанавливается для каждого дня недели
- Можно указать "Выходной"
- Можно указать "Круглосуточно"
- Влияет на:
  - Доступность онлайн-заказов
  - Расписание смен
  - Аналитику по часам

---

## Страница: Выбор меню

### 📍 Навигация
**URL:** `/onboarding/menu-template`

### 🎯 Цель страницы
Применение готового шаблона меню для быстрого старта.

### 📋 API Endpoints

#### 1. Получить список шаблонов
```http
GET /admin/onboarding/menu-templates?businessType=restaurant
```

**Response:**
```json
[
  {
    "id": 1,
    "name": "Итальянская пиццерия",
    "businessType": "pizzeria",
    "description": "Классическое меню итальянской пиццерии с пастой и салатами",
    "categoriesCount": 5,
    "productsCount": 32,
    "previewImage": "https://cdn.oshlab.uz/templates/italian-pizzeria.jpg",
    "categories": [
      { "name": "Пиццы", "count": 12 },
      { "name": "Паста", "count": 8 },
      { "name": "Салаты", "count": 6 },
      { "name": "Десерты", "count": 4 },
      { "name": "Напитки", "count": 2 }
    ]
  },
  {
    "id": 2,
    "name": "Кофейня — Базовое меню",
    "businessType": "coffee_shop",
    "categoriesCount": 4,
    "productsCount": 25
  }
]
```

#### 2. Применить шаблон
```http
POST /admin/onboarding/steps/menu-template

{
  "templateId": 1,
  "replaceExisting": false
}
```

**Response:**
```json
{
  "success": true,
  "message": "Меню успешно применено",
  "categoriesCreated": 5,
  "productsCreated": 32,
  "currentStep": "PAYMENT_SETUP",
  "completionPercentage": 57
}
```

### 🎨 UI Компоненты

```
┌─────────────────────────────────────────────────────┐
│  Шаг 4 из 7: Выберите готовое меню                 │
│  Прогресс: ████████████░░ 57%                       │
├─────────────────────────────────────────────────────┤
│                                                     │
│  Фильтр: [▼ Все типы заведений____________]         │
│                                                     │
│  ┌──────────────┐  ┌──────────────┐                │
│  │ 🖼️           │  │ 🖼️           │                │
│  │ Итальянская  │  │ Узбекская    │                │
│  │ пиццерия     │  │ кухня        │                │
│  │              │  │              │                │
│  │ 5 категорий  │  │ 6 категорий  │                │
│  │ 32 продукта  │  │ 28 продуктов │                │
│  │              │  │              │                │
│  │ [Просмотр]   │  │ [Просмотр]   │                │
│  │ [Выбрать] ✓  │  │ [Выбрать]    │                │
│  └──────────────┘  └──────────────┘                │
│                                                     │
│  ℹ️  Вы сможете отредактировать меню после запуска │
│                                                     │
│  [← Назад]  [Создать своё меню]  [Далее →]         │
└─────────────────────────────────────────────────────┘
```

**Предпросмотр шаблона:**
```
┌─────────────────────────────────────────────────────┐
│  Итальянская пиццерия                               │
│  32 позиции в 5 категориях                          │
├─────────────────────────────────────────────────────┤
│                                                     │
│  📂 Пиццы (12)                                      │
│    • Маргарита — 890₽                              │
│    • Пепперони — 990₽                              │
│    • Четыре сыра — 1,090₽                          │
│    ... ещё 9 позиций                               │
│                                                     │
│  📂 Паста (8)                                       │
│  📂 Салаты (6)                                      │
│  📂 Десерты (4)                                     │
│  📂 Напитки (2)                                     │
│                                                     │
│  [Закрыть]  [Выбрать этот шаблон]                  │
└─────────────────────────────────────────────────────┘
```

### 💡 Бизнес-логика

**Что происходит при применении шаблона:**
1. Создаются категории (с иерархией)
2. Создаются продукты с базовыми ценами
3. Создаются модификаторы (если есть в шаблоне)
4. Создаются дополнения (если есть)
5. Всё привязывается к текущему тенанту

**ReplaceExisting:**
- `false` — Добавить к существующему меню
- `true` — Удалить всё и применить шаблон (опасно!)

**Альтернатива — "Создать своё меню":**
- Пропускает этот шаг
- Создаёт пустое меню
- Пользователь добавляет позиции вручную после онбординга

---

## Страница: Платёжные методы

### 📍 Навигация
**URL:** `/onboarding/payment-setup`
**Можно пропустить:** ✅ Да

### 🎯 Цель страницы
Настройка интеграций с платёжными системами (Payme, Click, Uzum).

### 📋 API Endpoint

```http
POST /admin/onboarding/steps/payment-setup

{
  "cashEnabled": true,
  "cardEnabled": true,
  "paymeMerchantId": "123456789",
  "paymeSecretKey": "secret_key_here",
  "clickMerchantId": "987654",
  "clickServiceId": "12345",
  "clickSecretKey": "click_secret_key"
}
```

### 🎨 UI Компоненты

```
┌─────────────────────────────────────────────────────┐
│  Шаг 5 из 7: Настройте способы оплаты              │
│  Прогресс: ██████████████░ 71%                      │
├─────────────────────────────────────────────────────┤
│                                                     │
│  Базовые методы:                                    │
│  [✓] Наличные (всегда доступны)                    │
│  [✓] Банковская карта (терминал)                   │
│                                                     │
│  Онлайн платежи (необязательно):                    │
│                                                     │
│  ┌─ Payme ──────────────────────────────────┐      │
│  │ [✓] Включить Payme                        │      │
│  │ Merchant ID: [123456789____________]      │      │
│  │ Secret Key: [*********************]      │      │
│  │ [Проверить подключение]                   │      │
│  └───────────────────────────────────────────┘      │
│                                                     │
│  ┌─ Click ──────────────────────────────────┐      │
│  │ [ ] Включить Click                        │      │
│  │ Merchant ID: [_____________________]      │      │
│  │ Service ID: [_____________________]       │      │
│  │ Secret Key: [_____________________]       │      │
│  └───────────────────────────────────────────┘      │
│                                                     │
│  ⚠️  Онлайн платежи можно настроить позже          │
│                                                     │
│  [← Назад]  [Пропустить]  [Сохранить и далее →]   │
└─────────────────────────────────────────────────────┘
```

### 💡 Бизнес-логика

**Кнопка "Проверить подключение":**
```http
POST /admin/settings/test-payment-integration

{
  "provider": "payme",
  "merchantId": "123456789",
  "secretKey": "secret_key_here"
}

Response:
{
  "success": true,
  "message": "Payme подключён успешно",
  "balance": 1250000
}
```

**Пропуск шага:**
```http
PATCH /admin/onboarding/skip-step

{
  "step": "PAYMENT_SETUP",
  "reason": "Настрою позже"
}
```

---

## Страница: Приглашение сотрудников

### 📍 Навигация
**URL:** `/onboarding/staff-invite`
**Можно пропустить:** ✅ Да

### 🎯 Цель страницы
Пригласить менеджеров, кассиров и официантов до запуска.

### 📋 API Endpoint

```http
POST /admin/onboarding/steps/staff-invite

{
  "invitations": [
    {
      "fullName": "Анна Петрова",
      "phone": "+998901111111",
      "email": "anna@example.com",
      "roleId": 2,
      "branchIds": [1]
    },
    {
      "fullName": "Сергей Ковалёв",
      "phone": "+998902222222",
      "roleId": 3,
      "branchIds": [1]
    }
  ]
}
```

### 🎨 UI Компоненты

```
┌─────────────────────────────────────────────────────┐
│  Шаг 6 из 7: Пригласите сотрудников                │
│  Прогресс: ████████████████ 85%                     │
├─────────────────────────────────────────────────────┤
│                                                     │
│  Добавьте сотрудников:                              │
│                                                     │
│  ┌────────────────────────────────────────────┐    │
│  │ ФИО: Анна Петрова                          │    │
│  │ Телефон: +998 90 111 11 11                 │    │
│  │ Email: anna@example.com                    │    │
│  │ Роль: [▼ Менеджер___]                      │    │
│  │ Филиал: [✓ Пицца Хаус — Центр]            │    │
│  │ [🗑️ Удалить]                               │    │
│  └────────────────────────────────────────────┘    │
│                                                     │
│  [+ Добавить сотрудника]                            │
│                                                     │
│  ℹ️  Приглашения будут отправлены по SMS           │
│                                                     │
│  [← Назад]  [Пропустить]  [Отправить приглашения]  │
└─────────────────────────────────────────────────────┘
```

---

## Страница: Завершение онбординга

### 📍 Навигация
**URL:** `/onboarding/complete`

### 🎯 Цель страницы
Финальная проверка и запуск системы.

### 📋 API Endpoint

```http
POST /admin/onboarding/complete
```

**Response:**
```json
{
  "success": true,
  "message": "Поздравляем! Ваша система готова к работе",
  "tenant": {
    "id": 5,
    "businessName": "Пицца Хаус",
    "status": "active",
    "activatedAt": "2025-01-24T10:30:00Z"
  },
  "onboardingProgress": {
    "isCompleted": true,
    "completedAt": "2025-01-24T10:30:00Z",
    "completionPercentage": 100,
    "completedSteps": [
      "REGISTRATION_COMPLETE",
      "BUSINESS_INFO_VERIFIED",
      "BRANCH_SETUP",
      "MENU_TEMPLATE",
      "PAYMENT_SETUP",
      "STAFF_INVITED",
      "GO_LIVE"
    ]
  },
  "nextSteps": [
    {
      "title": "Настройте меню под себя",
      "link": "/admin/menu/products",
      "priority": "high"
    },
    {
      "title": "Добавьте сотрудников",
      "link": "/admin/staff",
      "priority": "medium"
    },
    {
      "title": "Проверьте POS приложение",
      "link": "/admin/settings/pos",
      "priority": "high"
    }
  ]
}
```

### 🎨 UI Компоненты

```
┌─────────────────────────────────────────────────────┐
│  🎉 Поздравляем! Вы готовы к запуску!              │
│  Прогресс: ████████████████ 100%                    │
├─────────────────────────────────────────────────────┤
│                                                     │
│  ✅ Регистрация завершена                           │
│  ✅ Информация о бизнесе сохранена                  │
│  ✅ Филиал настроен                                 │
│  ✅ Меню добавлено (32 позиции)                     │
│  ⏭️  Платёжные методы (пропущено)                  │
│  ⏭️  Сотрудники (пропущено)                        │
│  ✅ Система активирована                            │
│                                                     │
│  Что дальше:                                        │
│                                                     │
│  1. 📝 Отредактируйте меню под себя                │
│     [Перейти к меню →]                             │
│                                                     │
│  2. 👥 Добавьте сотрудников                        │
│     [Управление персоналом →]                       │
│                                                     │
│  3. 📱 Скачайте POS приложение                     │
│     [Инструкции по установке →]                     │
│                                                     │
│  [Начать работу →]                                  │
└─────────────────────────────────────────────────────┘
```

---

## Отслеживание прогресса

### 📊 API для отслеживания

```http
GET /admin/onboarding/progress
```

**Response:**
```json
{
  "currentStep": "PAYMENT_SETUP",
  "completedSteps": [
    "REGISTRATION_COMPLETE",
    "BUSINESS_INFO_VERIFIED",
    "BRANCH_SETUP",
    "MENU_TEMPLATE"
  ],
  "completionPercentage": 57,
  "isCompleted": false,
  "stepData": {
    "BUSINESS_INFO_VERIFIED": {
      "businessType": "restaurant",
      "completedAt": "2025-01-24T10:10:00Z"
    },
    "BRANCH_SETUP": {
      "branchId": 1,
      "branchName": "Пицца Хаус — Центр",
      "completedAt": "2025-01-24T10:15:00Z"
    },
    "MENU_TEMPLATE": {
      "templateId": 1,
      "categoriesCreated": 5,
      "productsCreated": 32,
      "completedAt": "2025-01-24T10:20:00Z"
    }
  },
  "skippedSteps": [],
  "createdAt": "2025-01-24T10:05:00Z",
  "updatedAt": "2025-01-24T10:20:00Z"
}
```

### 🎨 Прогресс-бар компонент

```typescript
// Пример React компонента
<OnboardingProgress
  currentStep="PAYMENT_SETUP"
  completedSteps={['REGISTRATION_COMPLETE', 'BUSINESS_INFO_VERIFIED', 'BRANCH_SETUP', 'MENU_TEMPLATE']}
  percentage={57}
/>

// Рендерит:
┌────────────────────────────────────────┐
│ Прогресс онбординга: 57%               │
│ ████████████░░░░░░░░░░░░               │
│                                        │
│ ✅ Регистрация                          │
│ ✅ Информация о бизнесе                 │
│ ✅ Настройка филиала                    │
│ ✅ Выбор меню                           │
│ 🔄 Платёжные методы ← Вы здесь         │
│ ⏸️  Приглашение сотрудников             │
│ ⏸️  Готово к запуску                    │
└────────────────────────────────────────┘
```

---

## 🔧 Технические детали

### Персистентность прогресса

- Прогресс сохраняется после каждого шага
- Можно вернуться назад и изменить данные
- Можно выйти и продолжить позже
- JWT токен сохраняется в localStorage

### Восстановление сессии

```typescript
// При загрузке приложения
const token = localStorage.getItem('accessToken');
if (token) {
  const progress = await fetch('/admin/onboarding/progress', {
    headers: { 'Authorization': `Bearer ${token}` }
  });

  if (!progress.isCompleted) {
    // Перенаправить на текущий шаг онбординга
    router.push(`/onboarding/${progress.currentStep}`);
  } else {
    // Перенаправить на dashboard
    router.push('/dashboard');
  }
}
```

### Защита от пропуска обязательных шагов

- Frontend проверяет `completedSteps` перед разрешением перехода
- Backend валидирует последовательность при POST запросах
- Нельзя завершить онбординг без обязательных шагов

---

**Версия документа:** 1.0
**Дата создания:** 2025-01-24
**Статус API:** ✅ Полностью реализовано
**Приоритет реализации:** Высокий (критично для масштабирования)
